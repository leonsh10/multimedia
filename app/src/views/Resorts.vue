<template>
  <div>
    <Header />
    <!-- PACKAGESSSSSSSSSSSSSSSSSSSSSSSS -->
    <div>
      <div class="main__div">
        <div class="all__packages">
          <div class="div__single-package">
            <div class="div-package__image">
              <img
                class="package__image"
                src="https://www.hospitalitynet.org/picture/xxl_153114275.jpg?t=1588578956"
              />
            </div>
            <div class="details">
              <div class="div__first-details">
                <p>Meliá Hotels & Resorts</p>
                <p>17 days ago</p>
              </div>
              <div class="div__second-details">
                <h4 class="second-details__h3">Meliá Hotels & Resorts</h4>
                <p class="second-details__p">
                  Meliá represents some of the finest and best-loved hotels in
                  the world with 350 resorts spread across 40 countries,
                  including Spain plus the Balearics and Canaries.
                </p>
              </div>
              <div class="div__last-details">
                <a style="font-weight: 600" href="#">Voyager</a>
                <a style="font-weight: 400, Regular" href="#"
                  >Claim this &#x2192;</a
                >
              </div>
            </div>
          </div>

          <div class="div__single-package">
            <div class="div-package__image">
              <img
                class="package__image"
                src="https://a.loveholidays.com/images/holidays/fcd198a6c22650b67deeba9a7092b0c8b68f75f7/holidays/fuerteventura/costa-de-antigua/globales-costa-tropical-0.jpg?auto=avif%2Cwebp&quality=45&dpr=2&optimize=high&fit=crop&width=840&height=577"
              />
            </div>
            <div class="details">
              <div class="div__first-details">
                <p>Globales Costa Tropical</p>
                <p>12 days ago</p>
              </div>
              <div class="div__second-details">
                <h4 class="second-details__h3">Globales Costa Tropical</h4>
                <p class="second-details__p">
                   Meliá represents some of the finest and best-loved hotels in
                  the world with 350 resorts spread across 40 countries,
                  including Spain plus the Balearics and Canaries.
                </p>
              </div>
              <div class="div__last-details">
                <a style="font-weight: 600" href="#">Voyager</a>
                <a style="font-weight: 400, Regular" href="#"
                  >Claim this &#x2192;</a
                >
              </div>
            </div>
          </div>

          <div class="div__single-package">
            <div class="div-package__image">
              <img
                class="package__image"
                src="https://a.loveholidays.com/images/holidays/ab0ed09f3987b53916223795d6db2f6667e24034/holidays/portugal/algarve/albufeira/muthu-clube-praia-da-oura-4.jpg?auto=avif%2Cwebp&quality=45&dpr=2&optimize=high&fit=crop&width=840&height=577"
              />
            </div>
            <div class="details">
              <div class="div__first-details">
                <p>Muthu Clube Praia Da Oura</p>
                <p>21 days ago</p>
              </div>
              <div class="div__second-details">
                <h4 class="second-details__h3">Muthu Clube Praia Da Oura</h4>
                <p class="second-details__p">
                  Meliá represents some of the finest and best-loved hotels in
                  the world with 350 resorts spread across 40 countries,
                  including Spain plus the Balearics and Canaries.
                </p>
              </div>
              <div class="div__last-details">
                <a style="font-weight: 600" href="#">Voyager</a>
                <a style="font-weight: 400, Regular" href="#"
                  >Claim this &#x2192;</a
                >
              </div>
            </div>
          </div>

          <div class="div__single-package">
            <div class="div-package__image">
              <img
                class="package__image"
                src="https://www.hospitalitynet.org/picture/xxl_153114275.jpg?t=1588578956"
              />
            </div>
            <div class="details">
              <div class="div__first-details">
                <p>Meliá Hotels & Resorts</p>
                <p>17 days ago</p>
              </div>
              <div class="div__second-details">
                <h4 class="second-details__h3">Meliá Hotels & Resorts</h4>
                <p class="second-details__p">
                   Meliá represents some of the finest and best-loved hotels in
                  the world with 350 resorts spread across 40 countries,
                  including Spain plus the Balearics and Canaries.
                </p>
              </div>
              <div class="div__last-details">
                <a style="font-weight: 600" href="#">Voyager</a>
                <a style="font-weight: 400, Regular" href="#"
                  >Claim this &#x2192;</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PACKAGESSSSSSSSSSSSSSSSSSSSSSS -->
    <main>
      <header>
        <!-- <h1 style="text-align: center">Resorts</h1> -->
      </header>
      <div id="content" class="mt-3">
        <section>
          <header>
            <h2>Meliá Hotels & Resorts</h2>
          </header>
          <p>
            Meliá represents some of the finest and best-loved hotels in the
            world with 350 resorts spread across <code>40</code> countries,
            including <code>Spain</code> plus the <code>Balearics</code> and
            <code>Canaries</code>. Here, first-class facilities meet unmatched
            service in breath-taking surroundings.
          </p>
          <canvas id="first"></canvas>
          <p>
            Meliá represents some of the finest and best-loved hotels in the
            world with 350 resorts spread across <code>40</code> countries,
            including <code>Spain</code> plus the <code>Balearics</code> and
            <code>Canaries</code>. Here, first-class facilities meet unmatched
            service in breath-taking surroundings. Meliá represents some of the
            finest and best-loved hotels in the world with 350 resorts spread
            across <code>40</code> countries, including <code>Spain</code> plus
            the <code>Balearics</code> and <code>Canaries</code>. Here,
            first-class facilities meet unmatched service in breath-taking
            surroundings.
          </p>
        </section>
        <section>
          <header>
            <h2>Globales Costa Tropical</h2>
          </header>
          <p>
            Located on the beautiful island of Fuerteventura, the 3-star
            Globales Costa Tropical Apartments offers plenty of activities,
            stunning surroundings and comfortable accommodation for the perfect
            sun-soaked <code>Canarian</code> escape. With clean and spacious,
            tastefully decorated accommodation, the Globales Costa Tropical
            Apartments Fuerteventura is the perfect place for a self catered
            holiday on this stunning island. Whip up a storm in the kitchenette,
            relax and unwind in the living room, or enjoy a cool beer on your
            balcony as you watch the <code>sunset</code>. There’s plenty to keep
            you active too, with table tennis, games and sports activities on
            offer. Looking for something more relaxing during your stay? Head to
            the swimming pool for a few gentle lengths or a quick dip to cool
            off after whiling away the hours soaking up the sunshine and
            watching the world go by. To help you relax further, head to the
            <code>sauna</code> or <code>Jacuzzi</code> and allow yourself to
            unwind. You are on holiday after all! Parents need not worry about
            the kids either, as the hotel has a pool just for them as well as a
            <code>playground</code>.
          </p>
          <canvas id="second"></canvas>
        </section>
        <section>
          <header>
            <h2>Muthu Clube Praia Da Oura</h2>
          </header>
          <p>
            The 4-star <code>Muthu Clube Praia da Oura</code> apartment complex
            in the resort of Praia da Oura, occupies a prime location in easy
            striking distance of a handful of <code>Portugal's</code> beautiful
            golden beaches, and just on the outskirts of the ever-popular
            Albufeira. All well-equipped, nicely decorated apartments don't just
            come with a kitchenette; they come with a full-on kitchen, with
            fridge freezer, oven or microwave, stovetop, flat-screen TV, DVD
            player and living and dining areas. Each has a private bathroom,
            with towels, bathrobes, toiletries and hairdryer. And they all have
            balconies with outdoor furniture - some have sun loungers. There's a
            good-sized swimming pool onsite, plus a
            <code>children's pool</code>. All surrounded by a sun terrace,
            dotted with sun loungers and parasols. Naturally, there's a
            <code>poolside</code> bar too, plus a further three bars, including
            Amanda's bar and a lobby bar, with TV - so, plenty of choice for a
            drink or two.
          </p>
          <canvas id="third"></canvas>
        </section>
      </div>
    </main>
    <div id="playfield"></div>
    <Footer class="mt-4" />
  </div>
</template>

<script>
import Header from "./Header.vue";
import Footer from "./Footer.vue";
export default {
  components: {
    Header,
    Footer,
  },
  mounted() {
    this.getAll();
  },
  methods: {
    getAll() {
      const first = window.first;
      const ctx1 = first.getContext("2d");
      /** @type {HTMLCanvasElement} */
      const second = window.second;
      const ctx2 = second.getContext("2d");
      /** @type {HTMLCanvasElement} */
      const third = window.third;
      const ctx3 = third.getContext("2d");
      const dpr = window.devicePixelRatio;

      let images = [];
      let playfield = null;

      function resize() {
        first.width = 800;
        first.height = 600;
        second.width = 800;
        second.height = 1200;
        third.width = 800;
        third.height = 600;

        const { width: fw, height: fh } = first.getBoundingClientRect();
        first.width = fw * dpr;
        first.height = fh * dpr;
        const { width: sw, height: sh } = second.getBoundingClientRect();
        second.width = sw * dpr;
        second.height = sh * dpr;
        const { width: tw, height: th } = third.getBoundingClientRect();
        third.width = tw * dpr;
        third.height = th * dpr;

        recalcPlayfield();
      }

      function recalcPlayfield() {
        const top = Math.min(
          first.offsetTop,
          second.offsetTop,
          third.offsetTop
        );
        const left = Math.min(
          first.offsetLeft,
          second.offsetLeft,
          third.offsetLeft
        );
        const width =
          Math.max(
            first.offsetLeft + first.offsetWidth,
            second.offsetLeft + second.offsetWidth,
            third.offsetLeft + third.offsetWidth
          ) - Math.min(first.offsetLeft, second.offsetLeft, third.offsetLeft);

        const height =
          Math.max(
            first.offsetTop + first.offsetHeight,
            second.offsetTop + second.offsetHeight,
            third.offsetTop + third.offsetHeight
          ) - Math.min(first.offsetTop, second.offsetTop, third.offsetTop);

        window.playfield.style.setProperty("--top", top + "px");
        window.playfield.style.setProperty("--left", left + "px");
        window.playfield.style.setProperty("--width", width + "px");
        window.playfield.style.setProperty("--height", height + "px");

        playfield = { top, left, width, height };
      }

      function loadImages() {
        const images = [
          "https://www.hospitalitynet.org/picture/xxl_153114275.jpg?t=1588578956",
          "https://a.loveholidays.com/images/holidays/fcd198a6c22650b67deeba9a7092b0c8b68f75f7/holidays/fuerteventura/costa-de-antigua/globales-costa-tropical-0.jpg?auto=avif%2Cwebp&quality=45&dpr=2&optimize=high&fit=crop&width=840&height=577",
          "https://a.loveholidays.com/images/holidays/ab0ed09f3987b53916223795d6db2f6667e24034/holidays/portugal/algarve/albufeira/muthu-clube-praia-da-oura-4.jpg?auto=avif%2Cwebp&quality=45&dpr=2&optimize=high&fit=crop&width=840&height=577",
        ];

        return images.map((src) => {
          const image = { img: new Image(), loaded: false };
          image.img.onload = () => (image.loaded = true);
          image.img.src = src;

          return image;
        });
      }

      const ball = {
        x: 0,
        y: 0,
        r: 20,
      };

      const mouse = {
        x: 0,
        y: 0,
        r: 20,
      };

      const colors = [
        "#f0a",
        "#f00",
        "#fa0",
        "#ff0",
        "#0f0",
        "#0ff",
        "#00f",
        "#a0f",
      ];

      function easeIn(p) {
        return Math.pow(p, 8);
      }

      function isVisible(element) {
        const rect = element.getBoundingClientRect();
        const viewHeight = Math.max(
          document.documentElement.clientHeight,
          window.innerHeight
        );

        return !(rect.bottom < 0 || rect.top - viewHeight >= 0);
      }

      function animate(now) {
        for (let { ctx, img } of [
          { ctx: ctx1, img: images[0] },
          { ctx: ctx2, img: images[1] },
          { ctx: ctx3, img: images[2] },
        ]) {
          if (!isVisible(ctx.canvas)) continue;
          ctx.strokeStyle = "#e9e9e9";
          ctx.fillStyle = "#0ff";
          ctx.lineWidth = 2;
          ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);

          const step = 42;

          for (let j = step; j < playfield.height; j += step) {
            ctx.beginPath();
            ctx.moveTo(
              0 - (ctx.canvas.offsetLeft - playfield.left) * dpr,
              j * dpr - (ctx.canvas.offsetTop - playfield.top) * dpr
            );
            ctx.lineTo(
              playfield.width * dpr -
                (ctx.canvas.offsetLeft - playfield.left) * dpr,
              j * dpr - (ctx.canvas.offsetTop - playfield.top) * dpr
            );
            ctx.stroke();
          }

          for (let i = step; i < playfield.width; i += step) {
            ctx.beginPath();
            ctx.moveTo(
              i * dpr,
              0 - (ctx.canvas.offsetTop - playfield.top) * dpr
            );
            ctx.lineTo(
              i * dpr,
              playfield.height * dpr -
                (ctx.canvas.offsetTop - playfield.top) * dpr
            );
            ctx.stroke();
          }

          const x = ball.x - (ctx.canvas.offsetLeft - playfield.left) * dpr;
          const y = ball.y - (ctx.canvas.offsetTop - playfield.top) * dpr;
          const r =
            Math.hypot(
              Math.max(playfield.width, playfield.height),
              Math.min(playfield.width, playfield.height)
            ) * 0.5;

          const lineWidth = ctx.lineWidth;
          const strokeStyle = ctx.strokeStyle;

          ctx.lineWidth = 4;
          let col = 0;
          const image = img;

          const d = (now * 0.000125) % 1;
          if (image.loaded) {
            const sslice = image.img.height - d * image.img.height;
            const dslice = ctx.canvas.height - d * ctx.canvas.height;
            ctx.drawImage(
              image.img,
              0,
              sslice,
              image.img.width,
              sslice,
              0,
              dslice,
              ctx.canvas.width,
              dslice
            );
          }

          ctx.globalCompositeOperation = "exclusion";

          for (let n = 0; n < r; n += r * 0.05) {
            const x0 =
              dpr * playfield.width * 0.5 -
              (ctx.canvas.offsetLeft * dpr - playfield.left * dpr);
            const y0 =
              dpr * playfield.height * 0.5 -
              (ctx.canvas.offsetTop * dpr - playfield.top * dpr);
            const r0 = dpr * r * easeIn(((n + now) * 0.000125) % 1);

            ctx.beginPath();
            ctx.arc(x0, y0, r0, 0, 7);
            ctx.strokeStyle = colors[col++ % colors.length];
            ctx.stroke();
          }

          ctx.globalCompositeOperation = "source-over";
          ctx.lineWidth = lineWidth;
          ctx.strokeStyle = strokeStyle;

          ctx.beginPath();
          ctx.arc(x, y, ball.r * dpr, 0, 7);
          ctx.fill();

          ctx.beginPath();
          ctx.arc(
            mouse.x * dpr -
              (ctx.canvas.offsetLeft * dpr -
                document.documentElement.scrollLeft * dpr),
            mouse.y * dpr -
              (ctx.canvas.offsetTop * dpr -
                document.documentElement.scrollTop * dpr),
            mouse.r * dpr,
            0,
            7
          );
          ctx.stroke();
        }

        ball.x += dpr;
        ball.y += dpr;

        if (ball.y - ball.r * dpr > playfield.height * dpr)
          ball.y = -ball.r * dpr;
        if (ball.x - ball.r * dpr > playfield.width * dpr)
          ball.x = -ball.r * dpr;
      }

      function loop(now) {
        animate(now);

        requestAnimationFrame(loop);
      }

      function init() {
        images = loadImages();
        resize();
        loop(0);
      }

      init();

      window.onresize = resize;

      function handleMouseMove(e) {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
      }
      document.onmousedown = (e) => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;

        document.addEventListener("mousemove", handleMouseMove);
      };
      document.onmouseup = () => {
        mouse.x = 0;
        mouse.y = 0;

        document.removeEventListener("mousemove", handleMouseMove);
      };

      function handleTouchMove(e) {
        const { touches } = e;
        const { clientX, clientY } = touches[0];

        mouse.x = clientX;
        mouse.y = clientY;
      }
      document.ontouchstart = (e) => {
        const { touches } = e;
        const { clientX, clientY } = touches[0];

        mouse.x = clientX;
        mouse.y = clientY;

        document.addEventListener("touchmove", handleTouchMove);
      };
      document.ontouchend = () => {
        mouse.x = 0;
        mouse.y = 0;

        document.removeEventListener("touchmove", handleTouchMove);
      };
    },
  },
};
</script>

<style scoped>
* {
  box-sizing: border-box;
}

.main__div {
  width: 100%;
  height: 700px;
  background-color: rgb(236, 236, 236);
}

.all__packages {
  width: 100%;
  height: 670px;
  display: flex;
  flex-direction: row;
  justify-content: space-evenly;
  align-items: center;
  /* border: 1px solid red; */
}

.div__single-package {
  border-radius: 15px;
  width: 21%;
  height: 67%;
  background-color: white;
}
.package__image {
  height: 100%;
  width: 100%;
  object-fit: cover;
  border-top-left-radius: 15px;
  border-top-right-radius: 15px;
}
.div-package__image {
  width: 100%;
  height: 45%;
}

.div__first-details {
  margin-top: 6px;
  width: 100%;
  height: 15%;
  display: flex;
  justify-content: space-between;
}

.div__first-details p {
  margin-top: 7px;
  color: #6e798c;
  font-style: normal;
  font-size: 13px;
  line-height: 15px;
}

.details {
  width: 90%;
  height: 55%;
  margin: 0 auto;
}

.div__second-details {
  width: 100%;
  height: 65%;
  outline: red;
}

.second-details__h3 {
  color: #081f32;
  font-size: 20px;
  font-weight: 600;
}

.second-details__p {
  margin-top: 15px;
  color: #374a59;
  font-size: 14px;
}

.div__last-details {
  margin: 0 auto;
  width: 80%;
  height: 13%;
  display: flex;
  justify-content: space-between;
}

.div__last-details a {
  text-decoration: none;
  font-size: 13px;
}

html,
body {
  margin: 0;
  font: 200 21px/28px system-ui;
  color: #2f2f2f;
  background-color: #f9f7f1;
}

main {
  margin: auto;
  padding: 0 1em;
}

canvas {
  width: 100%;
  height: auto;
  object-fit: contain;
}

#playfield {
  --left: 0px;
  --top: 0px;
  --width: 0px;
  --height: 0px;

  position: absolute;
  top: var(--top);
  left: var(--left);
  width: var(--width);
  height: var(--height);

  border: 2px dotted black;

  visibility: hidden;
}

@media screen and (min-width: 750px) {
  main {
  }
  #content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2em;
  }
}
</style>
